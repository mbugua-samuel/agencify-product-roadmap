WRMCB=function(e){var c=console;if(c&&c.log&&c.error){c.log('Error running batched script.');c.error(e);}}
;
try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-view-resources', location = 'view/roadmap-view/roadmap-view.js' */
define("confluence/confluence-roadmap-plugin/view/roadmap-view/roadmap-view",["jquery","ajs","confluence/legacy","skate"],function(d,b,e,a){var c=window.Roadmap=window.Roadmap||{};c.RoadmapView=d.extend(c.RoadmapView||{},{showBarDialog:function(h,g){this._barDialog&&this._barDialog.remove();var f=d(h.target).parents(".roadmap-macro-view").data("roadmap-macro-view");this._barDialog=new c.BarDialogView({trigger:d(h.target),model:{attributes:g},timelineWidth:d(h.target).parent(".svg-bar-overlay").width(),renderOption:{isEditMode:false,editInplace:{title:false,pageLink:true,description:false}},linkPageEditable:f.canUserEditPage,createLinkPageCallback:this._goToCreateLinkPage,updatePageLink:this._updatePageLink});this._barDialog.show()},_goToCreateLinkPage:function(h){h.preventDefault();var g=this.me;var j=d(g.options.trigger);var f=j.parents(".roadmap-macro-view").data("roadmap-macro-view");var i={roadmapHash:f.hash,version:f.version,roadmapBarId:g.options.model.attributes.id,roadmapContentId:f.id,updateRoadmap:true};e.RoadmapLink.addCreateLinkPageListener(i,function(m){var l=d('.bar-title[data-roadmap-bar*="'+m.barId+'"]');var k=l.data("roadmap-bar");k.pageLink=m.pageLink;l.attr("data-roadmap-bar",JSON.stringify(k));l.data("roadmap-bar",k);if(j.data("roadmap-bar").id==m.barId){j.trigger("click")}e.Roadmap.Analytics.addPageLinkViewMode({linkedPageId:m.pageLink.id,pageId:b.Meta.get("page-id")})})},_updatePageLink:function(h){var i=this;var g=d(this.trigger).closest(".roadmap-macro-view").data("roadmap-macro-view");var j;var f={roadmapContentId:g.id,roadmapHash:g.hash,version:g.version,roadmapBarId:this.model.attributes.id,updateRoadmap:true};if(d.isEmptyObject(h)){j=b.contextPath()+"/rest/roadmap/1.0/bar/pagelink/reset"}else{j=b.contextPath()+"/rest/roadmap/1.0/bar/pagelink/dolink";f=d.extend({},f,{linkedPageId:h.id})}d.ajax({type:"POST",contentType:"application/json",url:j,data:JSON.stringify(f),success:function(k){i.model.attributes.pageLink=h},error:function(k){b.log(k)}})}});return{_isInited:false,init:function(){if(this._isInited){return}this._isInited=true;a("roadmap-macro-view",{type:a.types.CLASS,events:{"click .bar-title":function(g,i,j){var h=d(j);i.target=j;var f=h.data("roadmap-bar");c.RoadmapView.showBarDialog(i,f);e.Roadmap.Analytics.openBarDialogInView()}}})}}});require("confluence/module-exporter").safeRequire("confluence/confluence-roadmap-plugin/view/roadmap-view/roadmap-view",function(a){a.init()});
}catch(e){WRMCB(e)};